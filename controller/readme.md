contains the main bussiness logic